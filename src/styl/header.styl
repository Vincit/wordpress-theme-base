fixedDesktopMenu = true
desktopMenuHeight = r(120px)
mobileMenuHeight = r(60px)

body {
  if (fixedDesktopMenu) {
    padding-top: desktopMenuHeight + r(20px)
  }

  @media media.medium, media.small, media.xsmall {
    padding-top: mobileMenuHeight + r(20px)
  }
}

.site-header {
  if (fixedDesktopMenu) {
    position: fixed
    top: 0
  }

  background: colors.orange
  color: colors.white
  width: 100%
  min-height: desktopMenuHeight
  display: flex
  align-items: center
  z-index: 1000

  @media media.medium, media.small, media.xsmall {
    display: none
  }

  .container {
    overflow: visible
  }

  a {
    color: colors.white
  }
}

body.admin-bar {
  if (fixedDesktopMenu) {
    .site-header {
      top: r(32px)
    }
  } else {
    .site-header {
      margin-bottom: r(20px)
    }
  }
}

.main-navigation {
  flex-basis: 100%
  display: flex
  flex-flow: row nowrap
  align-items: center
  justify-content: space-between

  .custom-logo-link {
    img {
      max-width: r(200px)
    }
  }

  .menu, .sub-menu {
    list-style: none
    padding: 0
    margin: 0
  }

  > .menu {
    flex-basis: 100%
    display: flex
    flex-flow: row nowrap
    justify-content: space-around

    .sub-menu {
      display: none
      position: absolute
      background: colors.white
      color: colors.black
      text-align: center
      margin-left: 50%
      transform: translateX(-50%)

      .sub-menu {
        // level 2 menu
        top: 0
        margin-left: 0
        transform: translateX(100%)
      }
    }
  }

  .menu-item {
    position: relative

    openSubmenu() {
      display: block
    }

    &.active {
      > a {
        color: colors.black
      }
    }

    &:hover {
      > .sub-menu {
        openSubmenu()
      }
    }

    a {
      color: currentColor
      padding: r(2px) r(5px)
      border-radius: r(2px)

      &:focus, &:hover {
        color: colors.black

        & + > .sub-menu {
          openSubmenu()
        }
      }
    }

    /*
      Keep menu open when focus is inside, browser support is okayish:
      http://caniuse.com/#feat=css-focus-within

      Problem resolved by @tnottu
    */
    &:focus-within  {
      > .sub-menu {
        openSubmenu()
      }
    }
  }

  .sub-menu {
    .menu-item {
      white-space: nowrap
      border-bottom: r(1px) solid colors.orange

      &:last-child {
        border-bottom: none
      }

      &.active {
        > a {
          color: colors.orange
        }
      }

      a {
        line-height: 1.4
        padding: r(5px) r(15px)

        &:hover {
          color: colors.orange
        }
      }
    }
  }
}

.mobile-header {
  width: 100%
  position: fixed
  top: 0
  left: 0
  display: none
  z-index: 1000
  max-height: mobileMenuHeight

  @media media.medium, media.small, media.xsmall {
    display: block
  }

  .header-bar {
    background: colors.orange
    box-shadow: 0px r(1px) r(5px) 0px rgba(colors.black ,0.75);
    max-width: 100vw
    overflow: hidden

    .container {
      max-width: 100%
      height: mobileMenuHeight
      display: flex
      align-items: center
      justify-content: space-between
    }

    .custom-logo-link {
      flex-basis: 30%
      max-width: r(150px)
    }

    .close-icon {
      display: none
    }

    button {
      appearance: none
      background: colors.white
      border-radius: 0
      padding: 0
      height: mobileMenuHeight
      width: @height

      img {
        max-width: r(24px)
      }
    }
  }

  &.menu-opened {
    max-height: auto

    .menu-toggle {
      .close-icon {
        display: inline
      }

      .open-icon {
        display: none
      }
    }
  }

  &.search-opened {
    .search-toggle {
      .close-icon {
        display: inline
      }

      .open-icon {
        display: none
      }
    }
  }

  .mobile-navigation {
    // display: none
    display: block
    transition: 0.2s ease-out
    transform: translateX(100%)

    &.open {
      display: block
      transition: 0.2s ease-in
      transform: translateX(0)
    }
  }

  .mobile-search {
    position: absolute
    top: 0
    height: mobileMenuHeight + r(1px)
    width: "calc(100% - %s)" % mobileMenuHeight
    transition: 0.2s ease-out
    transform: translateX(-100%)

    &.open {
      display: flex
      transform: translateX(0)
      transition: 0.2s ease-in
    }
  }

  .menu, .sub-menu {
    list-style: none
    padding: 0
    margin: 0
  }

  .sub-menu {
    display: none
  }

  .menu-item {
    display: flex
    flex-flow: column nowrap

    .item-wrapper { // Created with JS
      border-bottom: r(1px) solid colors.orange
      background: colors.gray
      color: colors.white
      display: flex
      flex-flow: row nowrap
      justify-content: space-between
      align-items: center
      min-height: r(50px)
    }

    &.active > .item-wrapper > a {
      color: colors.orange
    }

    &:last-child {
      .item-wrapper {
         border-bottom: 0
      }
    }


    a {
      font-size: r(20px)
      line-height: 1.5
      padding: 0 r(10px)
      color: inherit
    }

    .menu-handle { // Created with JS
      width: r(50px)
      background: none
      border-left: r(1px) solid colors.orange
      border-radius: 0
      padding: 0

      svg {
        fill: colors.white
      }

      img {
        // width: r(25px)
      }

      .close-icon {
        display: none
      }
    }

    &.open {
      > .sub-menu {
        display: block
      }

      > .item-wrapper > .menu-handle {
        .close-icon {
          display: inline
        }

        .open-icon {
          display: none
        }
      }
    }
  }
}

body.admin-bar {
  .mobile-header {
    top: 32px

    @media (max-width: 782px) {
      top: 46px
    }
  }
}
